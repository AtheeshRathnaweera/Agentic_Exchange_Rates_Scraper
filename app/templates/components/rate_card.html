{% macro rate_card(currency, rates) %}
{% set bg_map = {
"$": "bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-600",
"USD": "bg-gradient-to-br from-emerald-400 via-teal-500 to-cyan-600",
"â‚¬": "bg-gradient-to-br from-indigo-400 via-blue-500 to-cyan-600",
"EUR": "bg-gradient-to-br from-indigo-400 via-blue-500 to-cyan-600",
"Â£": "bg-gradient-to-br from-pink-400 via-purple-500 to-indigo-600",
"GBP": "bg-gradient-to-br from-pink-400 via-purple-500 to-indigo-600",
"Â¥": "bg-gradient-to-br from-red-400 via-pink-500 to-yellow-400",
"JPY": "bg-gradient-to-br from-red-400 via-pink-500 to-yellow-400",
"S$": "bg-gradient-to-br from-green-400 via-teal-500 to-blue-400",
"SGD": "bg-gradient-to-br from-green-400 via-teal-500 to-blue-400",
"A$": "bg-gradient-to-br from-yellow-400 via-orange-500 to-red-600",
"AUD": "bg-gradient-to-br from-yellow-400 via-orange-500 to-red-600",
"CHF": "bg-gradient-to-br from-gray-400 via-gray-500 to-gray-700",
"KWD": "bg-gradient-to-br from-yellow-300 via-yellow-500 to-yellow-700",
"OMR": "bg-gradient-to-br from-orange-300 via-orange-500 to-orange-700",
"SAR": "bg-gradient-to-br from-green-300 via-green-500 to-green-700",
"AED": "bg-gradient-to-br from-blue-300 via-blue-500 to-blue-700",
"QAR": "bg-gradient-to-br from-cyan-300 via-cyan-500 to-cyan-700",
"JOD": "bg-gradient-to-br from-red-300 via-red-500 to-red-700",
"BHD": "bg-gradient-to-br from-pink-300 via-pink-500 to-pink-700",
"â‚¹": "bg-gradient-to-br from-orange-400 via-yellow-500 to-green-400",
"INR": "bg-gradient-to-br from-orange-400 via-yellow-500 to-green-400",
"C$": "bg-gradient-to-br from-red-400 via-orange-500 to-yellow-400",
"CAD": "bg-gradient-to-br from-red-400 via-orange-500 to-yellow-400",
"NZ$": "bg-gradient-to-br from-green-400 via-blue-500 to-indigo-400",
"NZD": "bg-gradient-to-br from-green-400 via-blue-500 to-indigo-400"
} %}
{% set flag_map = {
"$": "ðŸ‡ºðŸ‡¸", "USD": "ðŸ‡ºðŸ‡¸",
"â‚¬": "ðŸ‡ªðŸ‡º", "EUR": "ðŸ‡ªðŸ‡º",
"Â£": "ðŸ‡¬ðŸ‡§", "GBP": "ðŸ‡¬ðŸ‡§",
"Â¥": "ðŸ‡¯ðŸ‡µ", "JPY": "ðŸ‡¯ðŸ‡µ",
"S$": "ðŸ‡¸ðŸ‡¬", "SGD": "ðŸ‡¸ðŸ‡¬",
"A$": "ðŸ‡¦ðŸ‡º", "AUD": "ðŸ‡¦ðŸ‡º",
"CHF": "ðŸ‡¨ðŸ‡­",
"KWD": "ðŸ‡°ðŸ‡¼",
"OMR": "ðŸ‡´ðŸ‡²",
"SAR": "ðŸ‡¸ðŸ‡¦",
"AED": "ðŸ‡¦ðŸ‡ª",
"QAR": "ðŸ‡¶ðŸ‡¦",
"JOD": "ðŸ‡¯ðŸ‡´",
"BHD": "ðŸ‡§ðŸ‡­",
"â‚¹": "ðŸ‡®ðŸ‡³", "INR": "ðŸ‡®ðŸ‡³",
"C$": "ðŸ‡¨ðŸ‡¦", "CAD": "ðŸ‡¨ðŸ‡¦",
"NZ$": "ðŸ‡³ðŸ‡¿", "NZD": "ðŸ‡³ðŸ‡¿"
} %}
{% set bg_class = bg_map.get(currency.symbol, "bg-gradient-to-br from-slate-700 via-slate-800 to-slate-900") %}
{% set flag = flag_map.get(currency.symbol, "ðŸ³ï¸") %}

{% set today_buy = rates.today.tt_buying | float %}
{% set yesterday_buy = rates.yesterday.tt_buying | float %}
{% set change = ((today_buy - yesterday_buy) / yesterday_buy * 100) if yesterday_buy else 0 %}
{% set change_str = ("%+.2f" % change) ~ "%" %}
{% set is_positive_change = change >= 0 %}

<div
  class="group relative bg-gradient-to-br from-slate-900/80 to-slate-800/80 backdrop-blur-sm border border-cyan-700/30 rounded-2xl p-4 sm:p-6 hover:border-cyan-500/50 transition-all duration-300 hover:shadow-lg hover:shadow-cyan-500/10"
  style="animation: 0.3s ease-out 0s 1 normal both running fadeIn;">
  <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
    <div class="flex items-center gap-3 sm:gap-4 flex-1">
      <div class="relative">
        <div
          class="w-12 h-12 sm:w-14 sm:h-14 {{ bg_class }} rounded-xl flex items-center justify-center shadow-lg shadow-cyan-500/20">
          <span class="text-xl sm:text-2xl text-white">{{ currency.symbol }}</span>
        </div>
        <div
          class="absolute -bottom-1 -right-1 w-5 h-5 sm:w-6 sm:h-6 bg-slate-900 rounded-full flex items-center justify-center border-2 border-cyan-700/50 shadow-md">
          <span class="text-xs sm:text-sm">{{ flag }}</span>
        </div>
      </div>
      <div class="flex-1 min-w-0">
        <div class="flex items-center gap-2 sm:gap-3 mb-1 flex-wrap">
          <h3 class="text-white">{{ currency.code }}</h3>
          <span data-slot="badge"
            class="inline-flex items-center justify-center rounded-md border px-2 py-0.5 font-medium w-fit whitespace-nowrap shrink-0 [&amp;&gt;svg]:size-3 gap-1 [&amp;&gt;svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden [a&amp;]:hover:bg-secondary/90 bg-cyan-500/20 text-cyan-300 border-cyan-500/30 hover:bg-cyan-500/30 text-xs">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
              class="lucide lucide-sparkles w-3 h-3 mr-1" aria-hidden="true">
              <path
                d="M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z">
              </path>
              <path d="M20 2v4"></path>
              <path d="M22 4h-4"></path>
              <circle cx="4" cy="20" r="2"></circle>
            </svg>
            <span class="hidden sm:inline">{{ rates.bank_name }}</span><span class="sm:hidden">Chase</span>
          </span>
        </div>
        <p class="text-slate-400 text-xs sm:text-sm truncate">{{ currency.name}}</p>
      </div>
    </div>
    <div class="flex items-center justify-between sm:justify-end gap-4 sm:gap-12">
      <div class="text-left sm:text-right">
        <p class="text-xs text-slate-500 mb-1">Buy Rate</p>
        <p class="text-lg sm:text-2xl text-white">{{ rates.today.tt_buying }}</p>
      </div>
      <div class="text-left sm:text-right">
        <p class="text-xs text-slate-500 mb-1">Sell Rate</p>
        <p class="text-lg sm:text-2xl text-white">{{ rates.today.tt_selling }}</p>
      </div>
      <div class="text-left sm:text-right min-w-[80px] sm:min-w-[100px]">
        <p class="text-xs text-slate-500 mb-1">24h Change</p>
        <div class="flex items-center justify-start sm:justify-end gap-1 sm:gap-2">
          {# <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-trending-up w-4 h-4 sm:w-5 sm:h-5 text-emerald-400" aria-hidden="true">
            <path d="M16 7h6v6"></path>
            <path d="m22 7-8.5 8.5-5-5L2 17"></path>
          </svg> #}
          {% if is_positive_change %}
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-trending-up w-4 h-4 sm:w-5 sm:h-5 text-emerald-400" aria-hidden="true">
            <path d="M16 7h6v6"></path>
            <path d="m22 7-8.5 8.5-5-5L2 17"></path>
          </svg>
          {% else %}
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
            class="lucide lucide-trending-down w-4 h-4 sm:w-5 sm:h-5 text-red-400" aria-hidden="true">
            <path d="M8 17H2v-6"></path>
            <path d="m2 17 8.5-8.5 5 5L22 7"></path>
          </svg>
          {% endif %}
          <span
            class="text-base sm:text-xl {% if is_positive_change %}text-emerald-400{% else %}text-red-400{% endif %}">{{
            change_str }}</span>
        </div>
      </div>
    </div>
  </div>
  <div
    class="absolute inset-0 bg-gradient-to-r from-cyan-500/0 via-blue-500/0 to-cyan-500/0 group-hover:from-cyan-500/5 group-hover:via-blue-500/5 group-hover:to-cyan-500/5 rounded-2xl transition-all duration-300 pointer-events-none">
  </div>
</div>
{% endmacro %}